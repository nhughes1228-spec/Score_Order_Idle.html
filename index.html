<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
  <title>Score Order Idle</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
<header>
  <div>
    <h1>Score Order Idle</h1>
    <div class="sub">Conduct with a baton, hire instruments, Ink is meta, “Take a bow” for Patrons.</div>
  </div>

  <div class="hud">
    <div class="tabs" aria-label="Pages">
      <!-- Start tab has no button; it's only shown automatically -->
      <button class="active" data-tab="main">Main</button>
      <button data-tab="stats">Stats</button>
      <button data-tab="achievements">Achievements</button>
      <button data-tab="prestige" id="prestigeTabBtn" hidden>Prestige</button>
      <button data-tab="settings">Settings</button>
    </div>

    <div class="pill"><span class="muted">Notes</span> <b class="mono" id="notesHud">0</b></div>
    <div class="pill"><span class="muted">Notes/sec</span> <b class="mono" id="npsHud">0</b></div>
    <div class="pill"><span class="muted">Click</span> <b class="mono" id="npcHud">1</b><span class="muted">/click</span></div>
    <div class="pill compact"><span class="muted">Ink</span> <b class="mono" id="inkHud">0</b></div>
    <div class="pill compact"><span class="muted">Patrons</span> <b class="mono" id="patronsHud">0</b></div>
  </div>
</header>

<main>
  <!-- START SCREEN (real screen) -->
  <div class="tab" id="tab-start" hidden>
    <div class="startWrap">
      <button class="startBtn" id="startBtn" aria-label="Start">
        <img src="assets/button-start.png" alt="Start" draggable="false"/>
      </button>
    </div>
  </div>

  <div class="tab" id="tab-main">
    <div class="grid">

      <section class="card">
        <h2>
          <span>The Score</span>
          <span class="tag good">Autosave: ON</span>
        </h2>
        <div class="content">
          <div class="clickZone">
            <button class="noteBtn" id="noteBtn" aria-label="Click the note"></button>

            <div class="bigNotes mono" id="bigNotes">0 Notes</div>

            <div class="miniHud">
              <div class="pill"><span class="muted">Notes/sec</span> <b class="mono" id="npsMini">0</b></div>
              <div class="pill"><span class="muted">Ink bonus</span> <b class="mono" id="inkBonusMini">x1.000</b></div>
              <div class="pill"><span class="muted">Patron bonus</span> <b class="mono" id="patronBonusMini">x1.00</b></div>
            </div>

            <!-- Removed: “In ink, we trust.” -->
          </div>

          <div class="table" id="batonShopList" style="margin-bottom:10px;"></div>

          <details class="dropdown" id="batonDropdown">
            <summary>
              <span>Baton Techniques (Notes)</span>
              <span class="tag" id="batonTag">Whole Note</span>
            </summary>
            <div class="detailsBody">
              <div class="muted smallSans" style="margin-bottom:8px;">
                These upgrades change your note symbol and multiply baton click power.
                (They reset when you “Take a bow.”)
              </div>
              <div class="table" id="batonUpgradeList"></div>
            </div>
          </details>

          <div class="row">
            <div>
              <b>Take a bow: Court Patrons</b>
              <div class="muted smallSans">Patron gains are based on <b>Notes earned this run</b>. Ink persists.</div>
              <div class="muted smallSans mono" id="runNotesLine">Run Notes: 0</div>
              <div class="muted smallSans mono" id="lifetimeNotesLine">Lifetime Notes: 0</div>
              <div class="muted smallSans mono" id="patronLine">You have: 0 Patron(s) • Take-a-bow Gain: +0</div>
              <div class="muted smallSans mono" id="nextPatronInfo">Next Patron in: — Notes</div>
            </div>
            <button class="primary" id="prestigeBtn">Take a bow</button>
          </div>

          <div class="footer">
            <span class="mono" id="clock">—</span>
            <span class="muted">Real note art + parchment background + baton cursor enforced.</span>
          </div>
        </div>
      </section>

      <section class="card">
        <h2>
          <span>Orchestra</span>
          <span class="seg" aria-label="Bulk buy mode" id="buyModeSeg">
            <span class="muted smallSans">Buy:</span>
            <button id="buy1"  class="active" data-buymode="1">x1</button>
            <button id="buy10" data-buymode="10">x10</button>
            <button id="buy100" data-buymode="100">x100</button>
            <button id="buyMax" data-buymode="max">Next</button>
          </span>
        </h2>
        <div class="content">
          <div class="muted smallSans" style="margin-bottom:8px;">
            Instruments are grouped by family. Each instrument has its own Upgrades dropdown.
          </div>

          <div class="familyStack" id="familyStack"></div>

          <div style="height:10px"></div>

          <details class="dropdown" id="inkDropdown">
            <summary>
              <span>Archive Upgrades (Ink — permanent)</span>
              <span class="tag">Meta</span>
            </summary>
            <div class="detailsBody">
              <div class="seg inkTabSeg" id="inkTabSeg" style="margin-bottom:8px;">
                <button data-inktab="nps" class="active">Notes/sec</button>
                <button data-inktab="clicknps">Click % of NPS</button>
                <button data-inktab="clickmult">Click Power</button>
              </div>
              <div class="table" id="inkUpgradeList"></div>
            </div>
          </details>

          <div class="footer">
            <span class="muted">Synergies boost whole families. Ladders boost individual instruments.</span>
            <span class="muted">Ink upgrades grow slowly, then compound.</span>
          </div>
        </div>
      </section>

    </div>
  </div>

  <div class="tab" id="tab-stats" hidden>
    <section class="card">
      <h2><span>Statistics</span><span class="tag">Read-only</span></h2>
      <div class="content">
        <div class="table" id="statsList"></div>
        <div class="footer">
          <span class="muted">Stats update live.</span>
          <span class="mono" id="statsClock">—</span>
        </div>
      </div>
    </section>
  </div>

  <div class="tab" id="tab-achievements" hidden>
    <section class="card">
      <h2>
        <span>Achievements</span>
        <span class="tag warn" id="achCountTag">0 / 0</span>
      </h2>
      <div class="content">
        <div class="muted smallSans" id="achBonusLine" style="margin-bottom:8px;">Bonuses: —</div>
        <div class="table" id="achievementsList"></div>
        <div class="unlockPanel">
          <div class="title">Recent Unlocks</div>
          <div class="table" id="recentUnlocksList"></div>
        </div>
        <div class="footer">
          <span class="muted">Each achievement gives a small permanent bonus.</span>
          <span class="mono" id="achClock">—</span>
        </div>
      </div>
    </section>
  </div>

  <div class="tab" id="tab-prestige" hidden>
    <section class="card">
      <h2><span>Performance Facility (Patrons)</span><span class="tag warn">Prestige Hall</span></h2>
      <div class="content">
        <div class="muted smallSans" style="margin-bottom:10px;">
          Spend Patrons to upgrade your facility. Patrons spent are gone, but facilities grant big global bonuses.
        </div>

        <div class="mini" style="margin-bottom:10px;">
          <div class="name">
            <div class="top">
              <b id="facilityName">—</b>
              <span class="tag warn" id="facilityBonus">—</span>
            </div>
            <div class="muted smallSans" id="facilityDesc">—</div>
          </div>
          <div class="right">
            <div class="cost mono" id="facilityPatrons">Patrons: —</div>
            <div class="cost mono" id="facilityEarned">Earned: —</div>
          </div>
        </div>
        <div class="venuePreview" id="facilityPreview" role="img" aria-label="Current venue"></div>

        <details class="dropdown" id="facilityUpgradesDetails">
          <summary>
            <span>Facility Upgrades</span>
            <span class="tag" id="facilityUpgradesTag">—</span>
          </summary>
          <div class="detailsBody">
            <div class="table" id="facilityUpgradesList"></div>
          </div>
        </details>

        <div style="height:10px"></div>

        <details class="dropdown" id="facilityNextDetails">
          <summary>
            <span>Move to a New Venue</span>
            <span class="tag" id="facilityNextTag">—</span>
          </summary>
          <div class="detailsBody">
            <div class="table" id="facilityNextList"></div>
          </div>
        </details>

        <div class="footer">
          <span class="muted">This hall appears after your first “Take a bow.”</span>
          <span class="mono" id="prestigeClock">—</span>
        </div>
      </div>
    </section>
  </div>

  <div class="tab" id="tab-settings" hidden>
    <section class="card">
      <h2><span>Settings</span><span class="tag warn">Be careful</span></h2>
      <div class="content">
        <label class="settingRow" for="settingSuffix">
          <input type="checkbox" id="settingSuffix"/>
          <span>Abbreviate numbers ≥ 1,000,000 (4 sig figs: 1.000M, 10.00M, 1.000B…)</span>
        </label>

        <div style="height:10px"></div>

        <div class="row">
          <div>
            <b>Save</b>
            <div class="muted smallSans">Autosave runs every 30 seconds, but you can save anytime.</div>
          </div>
          <button id="saveBtn">Save Now</button>
        </div>

        <div class="row">
          <div>
            <b>Hard Reset</b>
            <div class="muted smallSans">Erases everything (including Ink, Patrons, Facilities).</div>
          </div>
          <button class="danger" id="resetBtn">Hard Reset</button>
        </div>

        <div class="row">
          <div>
            <b>Reduce Motion</b>
            <div class="muted smallSans">Removes smooth transitions and movement effects.</div>
          </div>
          <label class="settingRow" for="settingReduceMotion">
            <input type="checkbox" id="settingReduceMotion"/>
            <span>Enable</span>
          </label>
        </div>

        <div class="row">
          <div>
            <b>High Contrast</b>
            <div class="muted smallSans">Boost readability and visual separation.</div>
          </div>
          <label class="settingRow" for="settingHighContrast">
            <input type="checkbox" id="settingHighContrast"/>
            <span>Enable</span>
          </label>
        </div>

        <div class="row">
          <div>
            <b>Disable Tooltips</b>
            <div class="muted smallSans">Turns off first-run guidance tooltips after the tutorial.</div>
          </div>
          <label class="settingRow" for="settingDisableTooltips">
            <input type="checkbox" id="settingDisableTooltips"/>
            <span>Disable</span>
          </label>
        </div>

        <div class="footer">
          <span class="muted">Tip: We can add more quality-of-life settings anytime.</span>
          <span class="mono" id="settingsClock">—</span>
        </div>
      </div>
    </section>
  </div>
</main>

<div class="mobileBar" id="mobileActionBar" hidden>
  <button id="mBuy1" data-mbuymode="1">x1</button>
  <button id="mBuy10" data-mbuymode="10">x10</button>
  <button class="primary noteDockBtn" id="mQuickNoteBtn" aria-label="Tap note"></button>
  <button id="mBuy100" data-mbuymode="100">x100</button>
  <button id="mBuyMax" data-mbuymode="max">Next</button>
</div>
<div class="desktopBuyDock" id="desktopBuyDock" hidden>
  <button id="dBuy1" data-dbuymode="1">x1</button>
  <button id="dBuy10" data-dbuymode="10">x10</button>
  <button id="dBuy100" data-dbuymode="100">x100</button>
  <button id="dBuyMax" data-dbuymode="max">Next</button>
</div>

<div class="toast" id="toast"></div>
<div class="achievementBanner" id="achievementBanner" hidden>
  <div class="shine"></div>
  <div class="kicker">Achievement Unlocked</div>
  <div class="name" id="achievementBannerName">—</div>
  <div class="bonus" id="achievementBannerBonus">—</div>
</div>

<!-- Tutorial coach-marks -->
<div class="overlay" id="tutorialOverlay" aria-hidden="true">
  <div class="veil" id="tutorialVeil">
    <div class="hole"></div>
  </div>
  <div class="panel">
    <h3 id="tutTitle">—</h3>
    <div class="msg" id="tutMsg">—</div>
    <div class="actions">
      <button id="tutSkipBtn">Skip</button>
      <button class="primary" id="tutNextBtn">Next</button>
    </div>
  </div>
</div>

<!-- Prestige explanation modal (first-run @ 500,000 run notes) -->
<div class="overlay" id="prestigeExplainOverlay" aria-hidden="true">
  <div class="veil"></div>
  <div class="panel">
    <h3>Prestige: “Take a bow”</h3>
    <div class="msg" style="margin-top:6px;">
      When you <b>Take a bow</b>, you reset your run (Notes, instruments, NOTE-upgrades, Synergies, Baton Techniques)…<br/>
      but you keep <b>Ink</b> and your <b>Archive Upgrades</b> permanently.<br/><br/>
      Your <b>Patron</b> gains are based on <b>Notes earned this run</b>. After you bow, you start earning Patrons from the beginning again (500,000 → …), while keeping all Patrons you’ve already earned overall.<br/><br/>
      Patrons unlock your <b>Performance Facility</b>—big global bonuses that grow over time.
    </div>
    <div class="actions">
      <button id="prestigeExplainGoHallBtn">Open Prestige Hall</button>
      <button class="primary" id="prestigeExplainOkBtn">Got it</button>
    </div>
  </div>
</div>

<div class="coachTip" id="coachTip" hidden>
  <h3 id="coachTipTitle">—</h3>
  <div class="msg" id="coachTipMsg">—</div>
  <div class="actions">
    <button id="coachTipDisableBtn">Don't show this message again</button>
    <button class="primary" id="coachTipOkBtn">Okay</button>
  </div>
</div>

<script src="game-data.js"></script>
<script src="render.js"></script>
<script src="economy.js"></script>
<script src="state-save.js"></script>
<script src="ui-events.js"></script>
<script src="main.js"></script>
</body>
</html>
